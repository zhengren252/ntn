# 测试环境配置文件
# 用于预生产测试和集成测试

# 应用环境
APP_ENV=staging
BUILD_TARGET=staging
LOG_LEVEL=INFO

# 端口配置
API_PORT=5001
FRONTEND_PORT=3001
REDIS_PORT=6380
ZMQ_PUB_PORT=5557
ZMQ_SUB_PORT=5558

# 数据库配置
DATABASE_URL=sqlite:///data/staging.db
REDIS_URL=redis://localhost:6380/1
REDIS_DB=1

# ZeroMQ配置
ZMQ_PUBLISHER_PORT=5557
ZMQ_SUBSCRIBER_PORT=5558
ZMQ_TOPIC_PREFIX=crawler.staging

# Telegram配置 (测试环境使用独立配置)
TELEGRAM_API_ID=${TELEGRAM_STAGING_API_ID}
TELEGRAM_API_HASH=${TELEGRAM_STAGING_API_HASH}
TELEGRAM_BOT_TOKEN=${TELEGRAM_STAGING_BOT_TOKEN}
TELEGRAM_SESSION_NAME=staging_session

# Scrapy配置
SCRAPY_CONCURRENT_REQUESTS=16
SCRAPY_DOWNLOAD_DELAY=2
SCRAPY_RANDOMIZE_DOWNLOAD_DELAY=1.0
SCRAPY_USER_AGENT=Mozilla/5.0 (compatible; NTN-Crawler-Staging/1.0; +http://staging.ntn.local/robots.txt)

# 代理配置
USE_PROXY=true
PROXY_LIST_URL=${PROXY_SERVICE_URL}
PROXY_ROTATION_INTERVAL=600
PROXY_VALIDATION_ENABLED=true

# 监控配置
MONITORING_ENABLED=true
METRICS_PORT=8001
HEALTH_CHECK_INTERVAL=30
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# 日志配置
LOG_FORMAT=json
LOG_FILE_MAX_SIZE=200MB
LOG_FILE_BACKUP_COUNT=10
LOG_TO_CONSOLE=true
LOG_TO_FILE=true
LOG_AGGREGATION_ENABLED=true

# 开发工具配置
DEBUG_MODE=false
HOT_RELOAD=false
AUTO_RESTART=true
DEV_MOUNT_SUFFIX=:ro

# 数据处理配置
DATA_VALIDATION_STRICT=true
DATA_CLEANUP_INTERVAL=1800
TEMP_FILE_RETENTION=43200
DATA_QUALITY_THRESHOLD=0.85

# 安全配置
API_RATE_LIMIT=500
API_RATE_LIMIT_WINDOW=3600
CORS_ORIGINS=http://localhost:3001,http://staging.ntn.local
CSRF_PROTECTION=true
API_KEY_REQUIRED=true

# 性能配置
WORKER_PROCESSES=2
WORKER_THREADS=8
MAX_MEMORY_USAGE=2GB
GC_THRESHOLD=0.7
CONNECTION_POOL_SIZE=20

# 测试配置
TEST_MODE=true
MOCK_EXTERNAL_APIS=false
TEST_DATA_RETENTION=7
AUTOMATED_TESTING=true

# 备份配置
BACKUP_ENABLED=true
BACKUP_INTERVAL=21600
BACKUP_RETENTION_DAYS=7
BACKUP_COMPRESSION=true

# 告警配置
ALERT_ENABLED=true
ALERT_EMAIL=${STAGING_ALERT_EMAIL}
ALERT_WEBHOOK=${STAGING_ALERT_WEBHOOK}
ALERT_THRESHOLD_ERROR_RATE=0.05
ALERT_THRESHOLD_RESPONSE_TIME=5000